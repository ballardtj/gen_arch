---
title: "R Notebook"
output:
  html_document:
    df_print: paged
---

Observed Model description:

* Hierarchical
* Weight parameters normally distributed, non-centered.
* Gradient parameters normally distributed, and explicitly truncated. Delta and Tau between 0 and 1. Alpha between 0.01 and 0.99.

Optimal Model description:

* Same as above

Run details: 

* Chains: 8
* Burnin: 4000
* Post-burnin: 10000
* Thinning: 10
* Total samples: 8000

Current issues with model:

?

# Observed Decisions

## Approach Condition

```{r,echo=FALSE,include=FALSE}
library(rstan)
library(coda)

hypers=c('w1_mean','w1_sd','w2_mean','w2_sd','w3_mean','w3_sd',
         'delta_mean','delta_sd','tau_mean','tau_sd','alpha_mean','alpha_sd')

load("data/derived/ap_obs_fit.RData")
```

### RStan output

```{r,echo=FALSE}
smrystan = summary(fit)
smrystan[[1]][hypers,]
```

### Coda output

Effective sample size

```{r,echo=FALSE}
stan2coda <- function(fit) {
  mcmc.list(lapply(1:ncol(fit), function(x) mcmc(as.array(fit)[,x,])))
}
effectiveSize(stan2coda(fit))[hypers]
```

Gelman's Rhat

```{r,echo=FALSE}
gelman.diag(stan2coda(fit))[[1]][hypers,]
```

### Plots

```{r,echo=FALSE}
rstan::traceplot(fit,par=hypers)
pairs(fit,pars=hypers)
```

## Avoidance Condition

```{r,echo=FALSE}
load("data/derived/av_obs_fit.RData")
```

### RStan output

```{r,echo=FALSE}
smrystan = summary(fit)
smrystan[[1]][hypers,]
```

### Coda output

Effective sample size
```{r,echo=FALSE}
effectiveSize(stan2coda(fit))[hypers]
```

Gelman's Rhat

```{r,echo=FALSE}
gelman.diag(stan2coda(fit))[[1]][hypers,]
```

### Plots

```{r,echo=FALSE}
rstan::traceplot(fit,par=hypers)
pairs(fit,pars=hypers)
```

# Optimal Decisions

## Approach Condition

```{r,echo=FALSE}
load("data/derived/ap_opt_fit.RData")
```

### RStan output

```{r,echo=FALSE}
smrystan = summary(fit)
smrystan[[1]][hypers,]
```

### Coda output

Effective sample size
```{r,echo=FALSE}
effectiveSize(stan2coda(fit))[hypers]
```

Gelman's Rhat

```{r,echo=FALSE}
gelman.diag(stan2coda(fit))[[1]][hypers,]
```

### Plots

```{r,echo=FALSE}
rstan::traceplot(fit,par=hypers)
pairs(fit,pars=hypers)
```


## Avoidance Condition

```{r,echo=FALSE}
load("data/derived/av_opt_fit.RData")
```

### RStan output

```{r,echo=FALSE}
smrystan = summary(fit)
smrystan[[1]][hypers,]
```

### Coda output

Effective sample size
```{r,echo=FALSE}
effectiveSize(stan2coda(fit))[hypers]
```

Gelman's Rhat

```{r,echo=FALSE}
gelman.diag(stan2coda(fit))[[1]][hypers,]
```

### Plots

```{r,echo=FALSE}
rstan::traceplot(fit,par=hypers)
pairs(fit,pars=hypers)
```
